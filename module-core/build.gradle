repositories {
    mavenCentral()
}

bootJar {
    enabled = false
}

jar {
    enabled = true
}

dependencies {
    implementation 'com.querydsl:querydsl-jpa'
}

configure('module-core') {
    apply plugin: "io.spring.dependency-management"

    dependencies {
        implementation 'com.github.ulisesbocchio:jasypt-spring-boot-starter:3.0.3'
        implementation 'org.apache.commons:commons-text:1.9'

        implementation "com.querydsl:querydsl-core"
        implementation "com.querydsl:querydsl-jpa"

        // querydsl JPAAnnotationProcessor 사용 지정
        // java.lang.NoClassDefFoundError(javax.annotation.Entity) 발생 대응
        // java.lang.NoClassDefFoundError (javax.annotation.Generated) 발생 대응
        annotationProcessor("com.querydsl:querydsl-apt:${dependencyManagement.importedProperties['querydsl.version']}:jpa")
        annotationProcessor("jakarta.persistence:jakarta.persistence-api")
        annotationProcessor("jakarta.annotation:jakarta.annotation-api")
    }

    /**인텔리제이 Annotation processor 에 생성되는 'src/main/generated' 디렉터리 삭제
     * 인텔리제이 annotation processor 가 생성한 Q클래스가 clean 태스크로 삭제되는 게 불편하다면 둘 중에 하나를 선택 */
    task cleanGeneatedDir(type: Delete) {
        delete file('src/main/generated')
    }
}